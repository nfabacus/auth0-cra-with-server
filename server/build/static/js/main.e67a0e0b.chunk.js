(this["webpackJsonpauth0-cra-with-server"]=this["webpackJsonpauth0-cra-with-server"]||[]).push([[0],{127:function(e,t,c){},128:function(e,t,c){},132:function(e,t){},134:function(e,t){},144:function(e,t){},146:function(e,t){},173:function(e,t){},174:function(e,t){},179:function(e,t){},181:function(e,t){},188:function(e,t){},207:function(e,t){},228:function(e,t,c){"use strict";c.r(t);var n=c(0),o=c.n(n),r=c(119),i=c.n(r),s=(c(127),c(65)),a=c(64),u=(c(128),function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}),l=c(27),d=c.n(l),h=function(e){return d.a.createHash("sha256").update(e).digest()},j=c(3),f=function(e){var t=e.user;return t?Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:null===t||void 0===t?void 0:t.picture,alt:null===t||void 0===t?void 0:t.name}),Object(j.jsx)("h2",{children:null===t||void 0===t?void 0:t.name}),Object(j.jsx)("p",{children:null===t||void 0===t?void 0:t.email})]}):Object(j.jsx)("div",{children:Object(j.jsx)("h2",{children:"No User Data"})})},p=function(e){var t=e.user;return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Log In Page"}),Object(j.jsx)("div",{children:t?Object(j.jsxs)("div",{children:[Object(j.jsx)(f,{user:t}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:function(){console.log("logout!")},children:"Log Out"})})]}):Object(j.jsx)("button",{onClick:function(){var e=u(d.a.randomBytes(32)),t=u(h(e)),c=u(d.a.randomBytes(32)),n=u(d.a.randomBytes(32)),o={nonce:n,code_verifier:e,scope:"openid profile email read:current_user update:current_user_metadata",audience:"https://abacus-coder.eu.auth0.com/api/v2/",redirect_uri:"http://localhost:3000"};sessionStorage.setItem("a0.spajs.txs",JSON.stringify(o));var r="https://".concat("abacus-coder.eu.auth0.com","/authorize?audience=").concat("https://abacus-coder.eu.auth0.com/api/v2/","&scope=").concat("openid profile email read:current_user update:current_user_metadata","&client_id=").concat("g7MowujHN5LTVoeRQSr1qXN8hMIewoLH","&redirect_uri=").concat("http://localhost:3000","&response_type=code&response_mode=query&state=").concat(c,"&nonce=").concat(n,"&code_challenge=").concat(t,"&code_challenge_method=S256&auth0Client=").concat("eyJuYW1lIjoiYXV0aDAtcmVhY3QiLCJ2ZXJzaW9uIjoiMS42LjAifQ==");window.location.href=r},children:"Log In"})})]})},b=function(){return Object(n.useEffect)((function(){console.log("csrfToken >>>",window.csrfToken)}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Dashboard"}),Object(j.jsx)("p",{children:"Hello, welcome!"})]})},O=function(e){if(console.log("handleErrors res >>",e),!e.ok)throw Error(e.statusText);return e.json()},v=c(120),g=c(4);var x=function(){var e=(window.location||{}).search,t=Object(n.useState)(null),c=Object(a.a)(t,2),o=c[0],r=c[1];return Object(n.useEffect)((function(){fetch("/api/verifyUser",{headers:{"Content-Type":"application/json","x-csrf-token":window.csrfToken},credentials:"include",cache:"no-cache"}).then(O).then((function(e){console.log("verify user result>>>",e),r(e)})).catch((function(e){console.log("verify error : ",e)}))}),[]),Object(n.useEffect)((function(){if(!o&&e){console.log("search exists!",e);var t=e.replace("?","").split("&").reduce((function(e,t){var c=t.split("="),n=Object(a.a)(c,2),o=n[0],r=n[1];return e[o]=r,e}),{}),c=sessionStorage.getItem("a0.spajs.txs");if(c){var n=Object(s.a)(Object(s.a)({},t),{},{code_verifier:JSON.parse(c).code_verifier});fetch("/api/access",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json","x-csrf-token":window.csrfToken},credentials:"include"}).then(O).then((function(e){console.log("result: ",e),r(e)})).catch((function(e){console.log("error: ",e)})),sessionStorage.removeItem("a0.spajs.txs")}}}),[e,o]),Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(v.a,{children:Object(j.jsxs)(g.c,{children:[Object(j.jsx)(g.a,{path:"/",children:Object(j.jsx)(p,{user:o})}),Object(j.jsx)(g.a,{path:"/dashboard",children:Object(j.jsx)(b,{})})]})})})},m=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,229)).then((function(t){var c=t.getCLS,n=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;c(e),n(e),o(e),r(e),i(e)}))};i.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(x,{})}),document.getElementById("root")),m()}},[[228,1,2]]]);
//# sourceMappingURL=main.e67a0e0b.chunk.js.map