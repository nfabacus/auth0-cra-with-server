(this["webpackJsonpauth0-cra-with-server"]=this["webpackJsonpauth0-cra-with-server"]||[]).push([[0],{129:function(e,t,n){},130:function(e,t,n){},135:function(e,t){},137:function(e,t){},147:function(e,t){},149:function(e,t){},176:function(e,t){},177:function(e,t){},182:function(e,t){},184:function(e,t){},191:function(e,t){},210:function(e,t){},231:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),r=n(120),i=n.n(r),a=(n(129),n(66)),s=n(65),u=(n(130),n(63)),d=n.n(u),l=n(121),h=function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},j=n(27),f=n.n(j),p=function(e){return f.a.createHash("sha256").update(e).digest()},b=n(3),O=function(e){var t=e.user;return t?Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{src:null===t||void 0===t?void 0:t.picture,alt:null===t||void 0===t?void 0:t.name}),Object(b.jsx)("h2",{children:null===t||void 0===t?void 0:t.name}),Object(b.jsx)("p",{children:null===t||void 0===t?void 0:t.email})]}):Object(b.jsx)("div",{children:Object(b.jsx)("h2",{children:"No User Data"})})},v=function(e){var t=e.user,n=e.setUser,c=function(){var e=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("logout!");try{fetch("/api/logout",{headers:{"Content-Type":"application/json","x-csrf-token":window.csrfToken},credentials:"include",cache:"no-cache"}),n(null)}catch(t){console.log(t)}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Log In Page"}),Object(b.jsx)("div",{children:t?Object(b.jsxs)("div",{children:[Object(b.jsx)(O,{user:t}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{onClick:c,children:"Log Out"})})]}):Object(b.jsx)("button",{onClick:function(){var e=h(f.a.randomBytes(32)),t=h(p(e)),n=h(f.a.randomBytes(32)),c=h(f.a.randomBytes(32)),o={nonce:c,code_verifier:e,scope:"openid profile email read:current_user update:current_user_metadata",audience:"https://abacus-coder.eu.auth0.com/api/v2/",redirect_uri:"http://localhost:3000"};sessionStorage.setItem("a0.spajs.txs",JSON.stringify(o));var r="https://".concat("abacus-coder.eu.auth0.com","/authorize?audience=").concat("https://abacus-coder.eu.auth0.com/api/v2/","&scope=").concat("openid profile email read:current_user update:current_user_metadata","&client_id=").concat("g7MowujHN5LTVoeRQSr1qXN8hMIewoLH","&redirect_uri=").concat("http://localhost:3000","&response_type=code&response_mode=query&state=").concat(n,"&nonce=").concat(c,"&code_challenge=").concat(t,"&code_challenge_method=S256&auth0Client=").concat("eyJuYW1lIjoiYXV0aDAtcmVhY3QiLCJ2ZXJzaW9uIjoiMS42LjAifQ==");window.location.href=r},children:"Log In"})})]})},x=function(){return Object(c.useEffect)((function(){console.log("csrfToken >>>",window.csrfToken)}),[]),Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Dashboard"}),Object(b.jsx)("p",{children:"Hello, welcome!"})]})},g=function(e){if(console.log("handleErrors res >>",e),!e.ok)throw Error(e.statusText);return e.json()},m=n(122),w=n(4);var _=function(){var e=(window.location||{}).search,t=Object(c.useState)(null),n=Object(s.a)(t,2),o=n[0],r=n[1];return Object(c.useEffect)((function(){fetch("/api/verifyUser",{headers:{"Content-Type":"application/json","x-csrf-token":window.csrfToken},credentials:"include",cache:"no-cache"}).then(g).then((function(e){r(e)})).catch((function(e){console.log("verify error : ",e)}))}),[]),Object(c.useEffect)((function(){if(!o&&e){var t=e.replace("?","").split("&").reduce((function(e,t){var n=t.split("="),c=Object(s.a)(n,2),o=c[0],r=c[1];return e[o]=r,e}),{}),n=sessionStorage.getItem("a0.spajs.txs");if(n){var c=Object(a.a)(Object(a.a)({},t),{},{code_verifier:JSON.parse(n).code_verifier});fetch("/api/access",{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json","x-csrf-token":window.csrfToken},credentials:"include"}).then(g).then((function(e){r(e)})).catch((function(e){console.log("error: ",e)})),sessionStorage.removeItem("a0.spajs.txs")}}}),[e,o]),Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(m.a,{children:Object(b.jsxs)(w.c,{children:[Object(b.jsx)(w.a,{path:"/",children:Object(b.jsx)(v,{user:o,setUser:r})}),Object(b.jsx)(w.a,{path:"/dashboard",children:Object(b.jsx)(x,{})})]})})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,232)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),o(e),r(e),i(e)}))};i.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(_,{})}),document.getElementById("root")),y()}},[[231,1,2]]]);
//# sourceMappingURL=main.0cb3385d.chunk.js.map